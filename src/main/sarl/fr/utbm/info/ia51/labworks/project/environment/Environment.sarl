package fr.utbm.info.ia51.labworks.project.environment

import io.sarl.core.Initialize
import fr.utbm.info.ia51.labworks.project.ui.MainFrame
import fr.utbm.info.ia51.labworks.project.car.Car
import io.sarl.core.DefaultContextInteractions
import io.sarl.core.Lifecycle
import fr.utbm.info.ia51.labworks.project.environment.^agent.RoadManager
import fr.utbm.info.ia51.labworks.project.road.Graph

agent Environment {
	uses RoadManager, DefaultContextInteractions, Lifecycle
	
	var UI : MainFrame
	var mesureFlux : double
	var tauxAccident : double
	var tempsTrajet : double
	var autonomousProportions : double
	var roads = new Graph
	
	on Initialize {
		var nbCar : int = occurrence.parameters.get(0) as Integer
		synchronized (this) {
			this.UI = occurrence.parameters.get(1) as MainFrame
		}
		//setSkill(new RoadManagerSkill())

		addCars(nbCar);
	}
	
	def addCars(nbCars : int) : void{
		for (i : 0 ..< nbCars) {
			var carBody = createCar()
			spawnInContextWithID(typeof(Car), carBody.agentId, defaultContext)
		}
	}
	
}